---
title: 'Excel基础与进阶'
date: 2023-8-9 09:03:02
cover: false
tags:
- 数据分析
categories: 数据分析
typora-root-url: Excel基础与进阶
---

# 引言

> 人的需求 >> 软件功能



数据场景

- 记录整理
- 数据计算
- 数据分析
- 数据展示

数据处理的挑战

- 数据太多
- 计算太累
- 需要价值和意义
- 需要协作

# 认识Excel

## Excel版本

![image-20240402171942053](image-20240402171942053.png)

![image-20240402172010782](image-20240402172010782.png)

![image-20240402172141838](image-20240402172141838.png)

## 初识Excel

![image-20240402172352533](image-20240402172352533.png)

![image-20240402173537574](image-20240402173537574.png)

[如何使用Win+R快捷键打开自定义程序)](https://www.cnblogs.com/-lyl/p/RunAnything.html)

![image-20240402173620095](image-20240402173620095.png)

## 基本操作

### 单元格内容

在单元格内填充的内容，可以分为以下三种基本数据类型

- 文本：默认左对齐，文本不可参与计算

- 数值：默认右对齐，数值计算精度为15位

- 逻辑值：默认居中对齐，`True`和`False`既能用来判断，也能参与计算

  ![image-20231205142120649](image-20231205142120649.png)

直接全选 - 删除，是不会清除掉单元格内容的格式的，需要点击`清除格式`选项卡

### 单元格格式

快捷键是`Ctrl + 1`

**单元格常规格式**

> 就是设置字体，对齐方式等

- 对齐
- 字体
- 边框
- 填充

人们常混淆的`边框`和`网格线`。网格线只是辅助查看的一个功能，打印是不显示的；可以在`视图`选项卡中调用它

**单元格数字格式**

- 常规格式，多数情况下，设置为“常规”格式的数字，即以键入的方式显示，但Excel可能不会对按你的预期对这些数字进行格式设置
- 文本格式，将单元格内的内容视为文本，并在键入时准确显示内容，即使键入数字也是如此
- 日期格式，Excel可将日期存储为序列号，以便可以在计算中使用它们。默认情况下，1900年1月1日为序列号1
- 自定义数字格式，以现有格式为基础，生成的自定义数字格式

![image-20231205143114341](image-20231205143114341.png)

### 数据录入

> 掌握不同的单元格格式

#### 数据录入规范

横向录入，保证每一条数据都是完整的

数据录入辅助快捷键

- `Tab`，光标选中后一个单元格
- `Shift + Tab`，光标选中前一个单元格
- `Enter`，光标选中下一个单元格
- `Shift + Enter`，光标选中上一个单元格

特殊格式数据录入

- 录入时间

  分隔符，用`-`或者`\`来分隔，才能被正确的识别为日期格式

  可以在开始菜单栏的数字格式中，将默认的短日期（`/`分隔）调整为长日期（年月日的形式）

  快捷键：输入当前日期：`Ctrl + ;`，输入当前时间：`Ctrl + Shift + ;` 可以先输入日期，敲一个空格，再输入时间。也可以直接输入`=NOW()`函数

- 录入百分比

  先设置单元格格式，然后输入；可以调整小数点后的数字

- 录入分数

  有两种形式，一个是小数据，如0.2，一个是分数，如`1/5`，第二种直接输入，会被认为是日期，需要输入个`0`加空格，再输入，就会被识别为分数

  也可以先设置单元格格式，再录入

- 录入长数据

  Excel数据录入的数据精度，只有15位；超过的位数编辑栏中会显示为0，显示栏会以科学计数法显示，输入`123456789012345678`，实际显示如下：

  ![image-20231204160829518](image-20231204160829518.png)

  类似身份证过长数据的录入，不能在数据格式下进行录入，而是要调整为**文本格式**

  ![image-20231204161158910](image-20231204161158910.png)

  文本型数字的单元格左上角，会有一个绿色的小三角，代表着这是一个文本型数字

  缺点：无法计算

  有点：可以完整的记录长数字

  小技巧：如果先输入了数字，但忘记调整单元格格式为文本了，可以在数字开始，输入英文下的逗号，也可以转换成文本格式

- 原位填充：输入数据后，按回车，光标会跳转到下一行的单元格，可以使用`Ctrl + Enter`，使得光标停留在原来的单元格。另外一个应用场景是，选中多个单元格后，输入，再`Ctrl + Enter`，可以全部填充

### 填充

#### 快速填充

- 快速填充，`Ctrl + E`；或者双击填充柄（单元格的右下角↘），然后选择快速填充

- 案例：适用相同格式的数据列，取同一位置的部分数据

  | 邮箱                                                         | 人名           |
  | ------------------------------------------------------------ | -------------- |
  | [john.doe@email.com](mailto:john.doe@email.com)              | john.doe       |
  | [emily.jones94@gmail.com](mailto:emily.jones94@gmail.com)    | emily.jones94  |
  | [sam.wilson@emailprovider.com](mailto:sam.wilson@emailprovider.com) | sam.wilson     |
  | [lisa.brown@emailhosting.com](mailto:lisa.brown@emailhosting.com) | lisa.brown     |
  | [robert.jenkins@emailservice.com](mailto:robert.jenkins@emailservice.com) | robert.jenkins |
  | [amy.chang@emailserver.com](mailto:amy.chang@emailserver.com) | amy.chang      |
  
- 场景

  **提取内容**，将括号中的规格提取为新一列：

  ```xml
  双汇火腿肠（5元*1根）
  康师傅方便面（3元*2包）
  哇哈哈矿泉水（2元*3瓶）
  维达抽纸（8元*1包）
  蒙牛纯牛奶（10元*2瓶）
  可口可乐汽水（4元*4听）
  光明酸奶（6元*3瓶）
  乐事薯片（7元*2包）
  红富士苹果（1元*5个）
  雀巢咖啡（12元*1罐）
  ```

  **拆分后重组合并**，新增一列，为姓氏加职位，样例：王部长：
  
  ```xml
  王宇	部长
  张美华	总经理
  赵子龙	主任
  刘文斌	部长
  郑小娟	副主席
  孙鑫	总监
  吴艳红	主管
  陈阳	经理
  周明	领导
  刘伟	总裁
  ```
  
  **数据拆分**，将人名和手机号拆分成两列：
  
  ```xml
  小丽 18438762553
  张伟 13987654321
  王芳 18765432109
  李雷 13659874213
  赵敏 18098765432
  刘洋 15012345678
  范冰 13567890123
  吴华 18234567890
  周婷 13345678901
  徐飞 18901234567
  ```
  
  案例：提取身份证号后4位，以及出生日期
  
  > 注意数字格式中，0的处理
  
  ```xml
  马勇涌—-332529198509040019
  姚瑶—-440102198609040026
  张军—-230227197004220015
  刘胜—-370882198903184217
  许磊—-320283198612130977
  杨宇—-120221199003230014
  王必忠—-330226198911237031
  王正中—-370911199407226013
  杨玉霞—-230226195701150045
  周文君—-320106198410290421
  ```
  
  
  
- 注意点

  如果快速填充操作报错，或者结果明显不对，确保要处理的数据列，中间没有空列。要保证处理的二维表是一个整体



### 分析

#### 快速分析



#### 格式化



#### 图表

- 迷你图，在`插入`选项卡中

#### 汇总

### 文件类型

|              格式               | 扩展名  | 说明 |
| :-----------------------------: | :-----: | :--: |
|           Excel工作簿           | `.xlsx` |      |
|       Excel启用宏的工作簿       | `.xlsm` |      |
|        Excel二进制工作簿        | `.xlsb` |      |
|              模板               | `xltx`  |      |
|          模板（代码）           | `.xltm` |      |
|   Excel 97 - Excel 2003工作簿   | `.xls`  |      |
|    Excel 97 - Excel 2003模板    | `.xlt`  |      |
| Microsoft Excel 5.0 / 95 工作簿 | `.xls`  |      |
|        XML电子表格 2003         | `.xml`  |      |
|            XML 数据             | `.xml`  |      |



### 常见快捷键

- 保存
  - 保存当前文件：`Ctrl + S`
  - 另存为：`F12`

## 函数

### 汇总统计



### 文本处理



### 时间计算



### 查找与匹配



## 可视化



## 数据透视表

其中`PowerQuery`就是`PowerBI`



## VBA

> 可以用python替代，用到时直接学就好

# 数据收集

> 注意，是收集，不是采集。
>
> 场景是让各部门或者各团队，填写某些固定模板的数据内容

## 协作工具

> 如果可以连通外网，可以使用多人协作工具

## 本地

> 只能本地Excel传递的话，一般来说会先做好Excel表头，再填写一条记录作为模板，让填写人参考

优化项：

- 增加输入提示，`数据 - 数据验证`或者是`数据 - 有效性`
- 设置数据验证出错警告，如身份证号会少填写，可以设置警告
- 下拉列表，当存在有限的可选值时，可以使用下拉列表，而不是手动输入；也是在`数据`菜单栏



## 数据合并

收到了不同人员或者部门填写的数据后，我们会收到10多个甚至几十个文件，可以使用数据查询，将统一模板的内容，导入到新表中（而不是一个个复制粘贴）

注意：如果存在文件加密，则导入不了

如果能用协作工具，最好用

## 收集网络数据

> 类似爬虫，只能做简单需求的表格类数据，非结构化数据无法处理

- 从url中获取单页数据：https://movie.douban.com/coming

- 实时获取数据：https://q.10jqka.com.cn/
  - 设置自动更新
  - 设置打开文件时更新数据

- 如果相对收集的数据，进行二次修改，请跳转`处理数据 - 数据清洗`小节

# 数据存储

## 数据存储的层次



# 查数据

## 数据展示

> 排序与自定义排序
>
> 自定义筛选和高级筛选



# 处理数据

## 替换



## 调整顺序



## 合并拆分





## 记录操作步骤



# 数据运算

> 公式和函数

## 数据清洗

导读：

- [这篇文章把数据讲透了（三）：数据清洗 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/338513987)

  

> 如果数据源来源于网络，不能直接在源数据上修改
>
> - 普通区域创建表快捷键，`Ctrl + T`
>
> 基本流程：
>
> - 检查原表：检查是否存在数据缺失/异常值/不规范的情况
> - 确认问题：和业务团队确认是否有收集信息的疏漏
> - 清洗数据：评估决定如何进行处理

`查询 - 编辑`（wps中是没有power query功能的）

# 数据可视化

## 数据展现的形式

> 常见数据的格式
>
> 自定义数据格式

## 突出感兴趣的数据

> 常见条件格式
>
> 自定义条件格式



# 数据挖掘



# 数据建模



# 数据协作

## 共享文档内容

> 文档加密
>
> 限制编辑
>
> 数据验证

## 协作办公



