---
title: '英雄联盟官网案例'
date: 2022/8/10 09:03:02
cover: false
tags:
- 案例实战
typora-root-url: 英雄联盟官网首页
---


[TOC]

视频链接：https://www.bilibili.com/video/BV1qS4y1z7iu

资源链接：https://pan.baidu.com/s/1H6NYwlmKiZSf4dN4ZqXhqg?pwd=ryuk 提取码：ryuk

> 掌握`HTML5/CSS3`核心知识及实战技巧
>
> 掌握`CSS3`中浮动/定位等布局方案
>
> 掌握`CSS3`中的`transition`和`animation`
>
> 掌握基于`flex`弹性盒模型的布局方案
>
> 同行排列的`N`种实现方案及优缺点对比
>
> `CSS3`样式编写中的模块思想及封装处理
>
> 掌握`JS`（包含`ES6+`）、`DOM`操作等核心知识
>
> 掌握`DOM`事件的核心知识及事件委托
>
> 掌握基于`JS+CSS3`动画的实战处理方案
>
> 掌握`Promise/async/await`异步管控方案
>
> 掌握`Ajax/Axios`的核心应用及数据绑定
>
> 基于`JS`管控`video`视频播放的解决方案
>
> 基于单例设计模式/`ESModule`实现模块化编程
>
> 基于`JS`实现页卡切换：两种不同处理思想
>
> 基于`JS`实现多种形态轮播图案例开发
>
> 基于`iscroll`插件实现局部滚动
>
> 基于`JS`实现“鼠标滑动的图片幻灯片”特效
>
> 基于`JS`打造炫酷的侧边栏楼层导航
>
> 人性化交互设计方案：`Loading&`防抖`&`节流
>
> 前端性能优化方案：图片懒加载`&`骨架屏`&Skeleton`



# 英雄联盟官网案例

## 模块化思想

- 基于`vue/react/webpack`工程化开发（项目中主流思想）

- 不想用工程化开发的方式，只想自己简单的写法页面，如何实现模块化呢？
  - `HTML`
  
    - 分版块设置结构（就写在一起了）
  
  - `CSS`
  
    - 基于前缀区分模块
  
    - 每个模块单独写在`CSS`文件中，最后不同模块统一导入到入口文件里，并利用`less/sass`的嵌套语法简化前缀书写
  
      - 首页`index.html`中导入`index.less`入口文件，同时通入编译`less`的`js`文件
  
        `index.html`
  
        ```html
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>英雄联盟官网</title>
        
            <!-- 导入less -->
            <link res="stylesheet/less" href="./css/index.less"></link>
            <script src="css/less.min.js"></script>
        </head>
        <body>
            
        </body>
        </html>
        ```
  
        `less`浏览器端编译文件下载：https://github.com/less/less.js/releases，下载后在`dist`文件夹
  
        `index.less`
  
        ```less
        // 公用样式
        
        @import './reset.min.css'; //格式化浏览器样式
        @import './common.less'; // 公用样式
        @import './head_box.less'; // 头部模块样式
        ```
  
  - `JS`：不能直接写在不同的`js`文件中然后导入，最后合并的时候仍然会有变量冲突，这里并不存在**模块**的概念
  
    - 基于闭包的方式，实现模块和模块之间变量隔离，防止全局变量污染，也可导出某个模块的方法
  
      ```js
      // 头部
      let headModule = (function () {
          let head_box = null,
              n = 0
      
          const query = function query () {
      
          }
      
          return {
              query
          }
      })()
      
      // 轮播图
      (function() {
          let swiper_box = null,
              n = 1
      
          headModule.query()
      })()
      ```
  
      这种模式就叫做：单例设计模式
  
    - 使用`<script type="module" src="./js/index.js"></script>`，直接让`js`支持`ES6Module`的模块化规范，这个声明只会在新版本浏览器中生效。此时在`index.js`就可以直接使用`import`语法了。
  
      拓展：https://www.freesion.com/article/15861435156/
  
      `index.html`
      
      ```html
      <!DOCTYPE html>
      <html lang="en">
      <head>
          <meta charset="UTF-8">
          <meta http-equiv="X-UA-Compatible" content="IE=edge">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title>英雄联盟官网</title>
      
          <!-- 导入less -->
          <link res="stylesheet/less" href="./css/index.less"></link>
          <script src="css/less.min.js"></script>
      </head>
      <body>
          <!-- 导入js入口文件 -->
          <script type="module" src="./js/index.js"></script>
      </body>
      </html>
      ```
  
      `index.js`
      
      ```js
      import './head_box.js' // 不是webpack环境，后缀要加上
      import './swiper_container.js'
      ```

其他准备：

- `axios、isScroll、qs`在`webpack`中挂载到`window`上并打包成`main.min.js`文件，方便使用

  ```js
  import Iscroll from 'iscroll'
  import axios from 'axios'
  import qs from 'qs'
  
  window.Iscroll = Iscroll
  window.qs = qs
  window.axios = axios
  ```

- 封装`axios`成`http.js`

  ```js
  const http = axios.create({
      // 统一请求前缀
      baseURL: 'http://127.0.0.1:8888',
      // 是否允许跨域时候携带资源凭证
      withCredentials: false,
      // 请求成功的状态码校验规则
      validateStatus: status => {
          return status >= 200 && status < 400;
      },
      // 请求头统一处理「设置请求主体专递给服务器的数据格式」
      headers: {
          'Content-Type': 'application/x-www-form-urlencoded'
      },
      // POST系列请求，请求主体传递信息的格式化
      transformRequest: (data, headers) => {
          if (data !== null && typeof data === "object") {
              const ct = headers['Content-Type'];
              if (ct === "application/x-www-form-urlencoded") {
                  return qs.stringify(data);
              }
          }
          return data;
      }
  });
  
  // 请求拦截器：向服务器发送请求之前
  http.interceptors.request.use(config => {
      // ...
      return config;
  });
  
  // 响应拦截器：获取到响应信息 ~ 自己处理业务逻辑之间
  http.interceptors.response.use(response => {
      // 获取响应主体信息
      return response.data;
  }, reason => {
      // 失败的统一处理「一般就是做相关的提示或者其它操作」
      let response = reason.response;
      if (response) {
          // 服务器有返回值，但是状态码不符合validateStatus校验规则
          switch (response.status) {
              case 400:
                  // ...
                  break;
              case 401:
                  // ...
                  break;
          }
      } else {
          // 服务器没有返回任何的信息
          if (reason && reason.code === "ECONNABORTED") {
              // 超时或者请求中断
          }
          if (!navigator.onLine) {
              // 网络出现故障
          }
      }
      return Promise.reject(reason);
  });
  
  // ES6Module中模块的导出:我想把当前模块中的某个方法，某些东西暴露出去供其他模块调用 export & export default
  export default http;
  ```

  如果当前某个模块在另外一个模块导入过了，以后在其他模块再次导入的话，最后浏览器渲染的时候，也只按导入一次处理
  
  拓展：
  
  - https://www.cnblogs.com/qiangyuzhou/p/10788246.html
  
  - https://blog.csdn.net/weixin_39838846/article/details/123646535
  
- `html`也可以进行模块化，但要基于第三方模板引擎，要学一些语法，做模板渲染，相对而言自己在`js`中动态拼接会简单点。直接将`html`写在一起也是没问题的

- 数据不直接写死，后台数据在`admin`文件夹（为了练习到`axios`）
  - `Node`版本`>12.0.0`
  - 启动：`node server.js`，注意不能关窗口，如果想要关闭窗口服务还在，安装`npm i pm2`，启动`pm2 start server.js --name lol`，结束`np2 stop lol`
  - 可以学习一下，`mock`数据怎么简单搭建成`api`服务



备注：实际真正开发的时候，还是会使用`webpack`静态资源打包器来进行开发的

## 头部导航模块

### 搭结构

- 尽可能减少层级嵌套，嵌套越深，性能消耗越大（涉及到浏览器底层渲染机制，`V8`引擎是怎么渲染的，从`DOM`树到`CSSOM`树，再到`RenderTree`）

- 尽可能标签语义化，让合理的标签做合适的事情，利于`seo`优化

- `H5`中都有哪些标签（要背，烂熟于心）：

- 画结构

  ![image-20220810164653879](image-20220810164653879.png)

- 我们用`vscode`的`liveServer`启动页面

- 根据结构写代码

  `index.html`

  ```html
  <!DOCTYPE html>
  <html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>英雄联盟官网</title>
  
      <!-- 导入less -->
      <link rel="stylesheet/less" href="./css/index.less"></link>
      <script src="css/less.min.js"></script>
  </head>
  <body>
      <script src="./js/main.min.js"></script>
      <!-- 导入js入口文件 -->
      <script type="module" src="./js/index.js"></script>
  
      <!-- 头部区域开始 -->
  		<div class="head-box">
  			<!-- 顶部 -->
  			<div class="common-head">
  				<!-- LOGO -->
  				<a href="" class="head-logo">
  					<img src="images/logo-public.png" alt="">
  				</a>
  				<!-- NAV -->
  				<nav class="head-nav">
  					<a href=""><span></span><span></span></a>
  					<a href=""><span></span><span></span></a>
  					<a href=""><span></span><span></span></a>
  					<a href=""><span></span><span></span></a>
  					<a href=""><span></span><span></span></a>
  				</nav>
  				<!-- 按钮组 -->
  				<a href="" class="head-search"></a>
  				<a href="" class="head-weixin">
  					<div class="wx-detail">
  						<img src="" alt="">
  						<p></p>
  						<img src="" alt="">
  					</div>
  				</a>
  				<!-- 个人中心 -->
  				<div class="head-person">
  					<div class="person-base">
  						<a href="" class="base-logo">
  							<img src="" >
  						</a>
  						<p></p>
  					</div>
  					<div class="person-detail">
  						<div class="detail-text">
  							<p></p>
  							<p></p>
  						</div>
  						<a class="detail-more" href="">
  							<i class="common-more"></i>
  						</a>
  					</div>
  				</div>
  			</div>
  			<!-- 顶部遮罩层 -->
  			<div class="common-head-mask">
  				
  			</div>
  			<!-- 作者区域 -->
  			<div class="author-box">
  				<span></span>
  				<span></span>
  				<a href=""></a>
  			</div>
  			<!-- 背景按钮 -->
  			<a href="" class="background-btn">
  				
  			</a>
  			<!-- 导航详情 -->
  			<div class="nav-detail">
  				<ul class="detail-con">
  					<li>
  						<a href=""></a>
  						<a href="">
  							<i class="icon-new"></i>
  						</a>
  					</li>
  					<li>
  						<a href=""></a>
  						<a href="">
  							<i class="icon-new"></i>
  						</a>
  					</li>
  					<li>
  						<a href=""></a>
  						<a href="">
  							<i class="icon-new"></i>
  						</a>
  					</li>
  				</ul>
  			</div>
  		</div>
  		<!-- 头部区域结束 -->
  </body>
  </html>
  ```

  `index.less`

  ```less
  // 公用样式
  
  @import './reset.min.css'; //格式化浏览器样式
  @import './common.less'; // 公用样式
  @import './head_box.less'; // 头部模块样式
  ```

  在结构上丰富内容：粘贴英雄联盟官网的文字、引入图片资源

  导航栏一般都是写死的，不涉及数据绑定

  `index.html`完善数据

  ```html
  <!DOCTYPE html>
  <html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>英雄联盟官网</title>
  
      <!-- 导入less -->
      <link rel="stylesheet/less" href="css/index.less"></link>
      <script src="css/less.min.js"></script>
  </head>
  <body>
      <!-- 头部区域开始 -->
  	<header class="head-box">
  		<!-- 顶部 -->
  		<div class="common-head">
  			<!-- LOGO -->
  			<a href="https://lol.qq.com" class="head-logo">
  				<img src="images/logo-public.png" alt="">
  			</a>
  			<!-- NAV -->
  			<nav class="head-nav">
  				<a href="https://101.qq.com/#/hero" target="_blank">
  					<span>游戏资料</span>
  					<span>GAME INFO</span>
  				</a>
  				<a>
  					<span>商城/合作</span>
  					<span>STORE</span>
  				</a>
  				<a>
  					<span>社区互动</span>
  					<span>COMMUNITY</span>
  				</a>
  				<a href="https://lpl.qq.com/"  target="_blank">
  					<span>赛事官网</span>
  					<span>ESPORTS</span>
  				</a>
  				<a>
  					<span>自助系统</span>
  					<span>SYSTEM</span>
  				</a>
  			</nav>
  			<!-- 按钮组 -->
  			<div class="head-search" title="搜索">
  				<span class="search-cancel"></span>
  				<input type="text" value="搜索lol.qq.com">
  			</div>
  			<a href="https://lol.qq.com/app/index.html" class="head-weixin" target="_blank">
  				<div class="wx-detail">
  					<img src="images/zm-qrcode.jpg">
  					<p>扫码下载掌上英雄联盟</p>
  					<img src="images/polo.gif">
  				</div>
  			</a>
  			<!-- 个人中心 -->
  			<div class="head-person">
  				<div class="person-base">
  					<a href="https://lol.qq.com/space/index.shtml" class="base-logo" target="_blank">
  						<img src="images/default.png" >
  					</a>
  					<span>
  						亲爱的召唤师，欢迎<a href="#">登录</a> 
  					</span>
  				</div>
  				<div class="person-detail">
  					<div class="detail-text">
  						<p>登录并且绑定大区后才可以查看您的具体信息哦<br/>
  							(包括战绩、资产、声望）
  						</p>
  						<p>官网个人信息显示略有延迟，请以游戏数据为准</p>
  					</div>
  					<a class="detail-more" href="https://lol.qq.com/space/index.shtml" target="_blank">
  						进入个人中心
  						<i class="common-more"></i>
  					</a>
  				</div>
  			</div>
  		</div>
  		<!-- 顶部遮罩层 -->
  		<div class="common-head-mask">
  			
  		</div>
  		<!-- 作者区域 -->
  		<div class="author-box">
  			<span>当前游戏版本</span>
  			<span>Ver 12.15</span>
  			<a href="https://lol.qq.com/gicp/news/410/37008396.html" target="_blank">版本详情</a>
  		</div>
  		<!-- 背景按钮 -->
  		<a href="https://lol.qq.com/act/a20220715starguardianpass/index.html?_code=507041" target="_blank" class="background-btn">
  			查看详情
  		</a>
  		<!-- 导航详情 -->
  		<div class="nav-detail">
  			<ul class="detail-con">
  				<li>
  					<a href="https://lol.qq.com/download.shtml?ADTAG=innercop.lol.web.top" target="_blank">游戏下载</a>
  					<a href="https://lol.qq.com/data/newbie-what.shtml" target="_blank">新手指引</a>
  					<a href="https://101.qq.com/#/page-index/tab-index" target="_blank">资料库</a>
  					<a href="https://lol.qq.com/tft/"  target="_blank">
  						<i class="icon-new"></i>
  						云顶之弈
  					</a>
  					<a href="https://101.qq.com/"  target="_blank">
  						<i class="icon-new"></i>
  						攻略中心
  					</a>
  					<a href="https://lol.qq.com/nexus/pc/" target="_blank">开发者基地</a>
  					<a href="https://lol.qq.com/act/a20171205hextech/" target="_blank">海克斯战利品库</a>
  					<a href="https://yz.lol.qq.com/" target="_blank">英雄联盟宇宙</a>
  				</li>
  				<li>
  					<a href="https://lol.qq.com/comm-htdocs/pay/new_index.htm?t=lol" target="_blank">点券充值</a>
  					<a href="https://daoju.qq.com/lol/"  target="_blank">
  						<i class="icon-hot"></i>
  						道聚城
  					</a>
  					<a href="https://lolriotmall.qq.com/index.shtml?ADTAG=lol.rk.gw.top&adunionsid=gwtop" target="_blank">周边商城</a>
  					<a href="https://lol.qq.com/act/a20161011mvm/index.htm" target="_blank">LOL桌游</a>
  					<a href="https://cafe.qq.com/tpl/lol/index.html" target="_blank">网吧特权</a>
  					<a href="https://lol.qq.com/act/a20181124novel/?ADTAG=innercop.lol.web.top" target="_blank">电竞小说</a>
  				</li>
  				<li>
  					<a href="https://lol.qq.com/v/v2/index.shtml" target="_blank">视频中心</a>
  					<a href="https://lol.qq.com/act/a20160425wxlol/" target="_blank">官方微信</a>
  					<a href="https://weibo.com/lol" target="_blank">官方微博</a>
  					<a href="https://tr.lol.qq.com/" target="_blank">玩家创作馆</a>
  					<a href="https://lol.qq.com/act/a20180418yxny/" target="_blank">玩家服务</a>
  					<a href="https://lol.qq.com/act/a20200319clash/index.html?e_code=458230"  target="_blank">
  						<i class="icon-new"></i>
  						LOL组队专区
  					</a>						
  					<a href="https://lol.qq.com/author/#/homepage"  target="_blank">
  						<i class="icon-new"></i>
  						作者入驻计划
  					</a>						
  					<a href="https://lol.icreate.qq.com/v3"  target="_blank">
  						<i class="icon-new"></i>
  						英雄联盟素材库
  					</a>
  				</li>
  				<li>
  					<a href="https://lpl.qq.com/es/msi/2022/"  target="_blank">
  						<i class="icon-hot"></i>
  						季中冠军赛
  					</a>
  					<a href="https://lpl.qq.com/es/lpl/2022/"  target="_blank">
  						<i class="icon-hot"></i>
  						LPL职业联赛
  					</a>
  					<a href="https://lpl.qq.com/es/ldl/2022/" target="_blank">LDL发展联赛</a>
  					<a href="https://lpl.qq.com/es/worlds/2021/" target="_blank">全球总决赛</a>
  					<a href="https://lpl.qq.com/act/a20220322city/" target="_blank">城市英雄争霸赛</a>
  					<a href="https://lpl.qq.com/act/a20211206demacia/index.html" target="_blank">德玛西亚杯</a>
  					<a href="https://lpl.qq.com/act/a20210928lcl/index.html" target="_blank">全国高校联赛</a>
  					<a href="https://lpl.qq.com/es/toc3"  target="_blank">
  						<i class="icon-new"></i>
  						云顶之弈公开赛
  					</a>
  				</li>
  				<li>
  					<a href="https://lol.qq.com/act/a20210625icon/index.html"  target="_blank">
  						<i class="icon-hot"></i>
  						图标自助领取
  					</a>
  					<a href="https://lol.qq.com/act/a20200710transferzone/index.html"  target="_blank">
  						<i class="icon-new"></i>
  						转区系统
  					</a>
  					<a href="javascript:void(0)">
  						<i class="icon-hot"></i>
  						封号查询
  						<span style="display:none;">
  							<img src="./images/qr-fhcx.png" alt="封号查询">
  							<span>请前往“腾讯游戏安全中心”公众号-自助服务进行处罚查询</span>
  						</span>
  					</a>
  
  					<a href="https://lol.qq.com/act/a20200227logout/" target="_blank">账号注销</a>
  					<a href="https://lol.qq.com/act/a20190528lolscore/"  target="_blank">
  						<i class="icon-hot"></i>
  						信誉分系统
  					</a>
  					<a href="https://lol.qq.com/act/a20150326dqpd/" target="_blank">服务器状态查询</a>
  					<a href="https://lol.qq.com/act/a20171108ambient/index.html" target="_blank">秩序殿堂</a>
  					<a href="https://lol.qq.com/act/a20191210super/index.shtml" target="_blank">峡谷之巅</a>
  				</li>
  
  			</ul>
  		</div>
  	</header>
  	<!-- 头部区域结束 -->
  
  	<script src="js/main.min.js"></script>
      <!-- 导入js入口文件 -->
      <script type="module" src="js/index.js"></script>
  </body>
  </html>
  ```

  效果：

  ![image-20220812063412015](image-20220812063412015.png)

- 写结构心得：

  - 先写大结构，再写小结构，从外到内，将看到的页面内容，用合适的标签元素表达出来
  - 鼠标悬停出来的结构，和悬停对象作为整体，写在一个结构中
  - 可以同时定义类名，尽量语义化（熟练了的话，这一步直接就可以用预先定义好的类名，同时写样式和布局，如：`<div class="bg-red font-16 col-8"`）



- 从外到内，先写大结构
- 元素自身样式，可按以下顺序一一书写
  - 先固定好元素整体大框架：元素的位置以及布局
    - 控制显示与隐藏
    - 控制位置
      - `display`的类型
        - 考虑子元素的布局，要不要用`flex`
      - 考虑要不要用到`position`属性
  - 再控制大小
    - 基于盒子模型顺序书写：
      - 宽高、内边距、边框、外边距
      - 背景图
  - 最后完善细节：
    - 字体相关：字体大小、颜色等



### 头部整体

`.head-box`

```css
// 头部样式

.head-box {
    position: relative;
    height: 360px;
    background-image: url('../images/top_banner.jpeg');
    background-size: cover;
    overflow: hidden;
}
```

![image-20220813071717509](image-20220813071717509.png)

然后接着`head-box`后面，加上前缀继续写样式（`css`写法），从性能角度来讲，前缀越短性能越好，因为浏览器渲染`css`时，选择器渲染顺序是从右到左，前缀越长，浏览器识别解析的东西就越多

但是呢，实际我们还不能忽略前缀问题，否则很容易出现样式冲突的问题，只能是尽可能减少

`.head-box .comm-head .head-logo {}`这种方式写法上有点麻烦，我们可以用`less、saas`等预处理器的嵌套语法

```css
// 头部样式

.head-box {
    position: relative;
    height: 360px;
    background-image: url('../images/top_banner.jpeg');
    background-size: cover;
    overflow: hidden;
    .comm-head {
        
        .head-logo {
            
        }
    }
}
```

编译后的结果，是带有前缀的

新手写样式，通常是看到哪儿写到哪，该方式有助于学习

高手写样式，一开始是不会直接去写具体模块的样式，会先把整个页面的所有情况看完了，之后脑子里形成了雏形：这一块样式是公共的，这一块样式应该怎么写等等。然后先把公共的样式写了，写完后再写具体模块的样式，遇到已经写过的公共样式时，直接写个类名就好

如：

`common.less`

```css
.w1300 {
    width: 1300px;
    margin: 0 auto;
}
```

给`head-box`指定类名

```html
<div class="common-head w1300">
    
</div>
```

目前我们可能达不到这种效果，介于两者之前，先一步一步写，然后遇到可以抽离成公共写样式的就抽离

>  工程化开发时，一般会有基础样式库，自建库或第三方库，如`Tailwind.css`，演示网址：https://www.tailwindcss.cn/

父子元素嵌套的场景下

- 父元素不指定高度，可以子元素指定高度撑开父元素
- 子元素不指定高度，父元素指定高度，而子元素高度设置`100%`

这里我们再给`common-head`设置固定的高度撑开父元素

```css
  .common-head {
    height: 78px;
    .head-logo {

    }
  }
```

同时给遮罩层也设置高度，并设置渐变背景图片，同时抽离出公共样式

注意遮罩的层级要低一点

- 如果不给元素设置定位，设置层级是没有用的
- 设是`common-head`为`relative`定位

```css
// 头部样式

.head-box {
    position: relative;
    height: 360px;
    background-image: url('../images/top_banner.jpeg');
    background-size: cover;
    overflow: hidden;
    .common-head,
    .common-head-mask {
        height: 78px;
    }
    .common-head-mask {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        background: url('../images/dark-jianbian-repeatx-0.png') repeat-x;
        background-size: 1px 100%;
        z-index: 10;
    }
    .common-head {
        position: relative;
        z-index: 11;
    }
}

```

现在要水平排列`head-box`里的元素，这里用`float`实现，在此之前给`head-box`添加`clearfix`样式类（在`reset.min.css`中）清除子元素浮动给父元素带来的影响（子元素浮动脱离文档流，如果父元素没有设置高度，则父元素无法被子元素撑开）

```html
<header class="head-box clearfix">
	
</header>
```

设置浮动

```less
    .common-head {
        position: relative;
        z-index: 11;
        .head-logo,
        .head-nav,
        .head-search,
        .head-weixin,
        .head-person {
            float: left;
            padding-top: 10px;
        }
        .head-search,
        .head-weixin,
        .head-person {
            float: right;
        }
    }
```

调整`.head-search, .head-weixin, .head-person`的结构顺序，这三个设置右浮动后，`head-search`跑到了最右边，`html`结构中和`head-person`换一下位置

### 头部图标

`head-logo`样式

```less
        // LOGO
        .head-logo {
            width: 167px;
            height: 60px;
            img {
                width: 100%;
                height: 100%;
            }
        }
```

将所有的`img`元素设置为块级元素，写到`common.less`中

```less
img {
    display: block;
}
```

![image-20220815063622515](image-20220815063622515.png)

给`img`元素添加`alt="英雄联盟"`，利于`seo`

### 头部导航

`head-nav`样式

在全局将所有盒子的盒子模型属性设置成`border-box`，这样设置宽高时，包含了`padding`和`border`

`common.less`

```less
* {
  box-sizing: border-box;
}
```

```less
    // head-nav
    .head-nav {
      height: 100%;
      padding-top: 15px;
      margin-left: 20px;
    }
```

`head-nav`里面元素的大结构，也是同一行排列，这里我们用`flex`布局

给`head-nav`的每个子元素`a`添加`item`类名，添加`nav-title`和`nav-subtitle`类名

```html
<nav class="head-nav">
    <a href="https://101.qq.com/#/hero" target="_blank" class="item">
        <span>游戏资料</span>
        <span>GAME INFO</span>
    </a>
    <a class="item">
        <span>商城/合作</span>
        <span>STORE</span>
    </a>
    <a class="item">
        <span>社区互动</span>
        <span>COMMUNITY</span>
    </a>
    <a href="https://lpl.qq.com/" target="_blank" class="item">
        <span>赛事官网</span>
        <span>ESPORTS</span>
    </a>
    <a class="item">
        <span>自助系统</span>
        <span>SYSTEM</span>
    </a>
</nav>
```

```less
    // head-nav
    .head-nav {
      display: flex;
      justify-content: flex-start;
      height: 100%;
      padding-top: 15px;
      margin-left: 20px;
      .item {
        width: 140px;
        height: 100%;
      }
    }
```

再设置每个`item`里的大标题和小标题

```less
.item {
    width: 140px;
    height: 100%;
    .nav-title, .nav-subtitle {
        display: block;
        color: #fff;
        text-align: center;
        letter-spacing: 1px;
    }
    .nav-title {
        font-size: 18px;
        line-height: 28px;
    }
    .nav-subtitle {
        color: #aeaeae;
        font-size: 12px;
        line-height: 18px;
    }
}
```

效果：

![image-20220815142629174](image-20220815142629174.png)

### 导航详情

#### 页面样式

给`head-nav`添加悬浮显示效果

编写`nav-detail`样式

- 通栏、半透明背景
- 每一栏的样式
- `ul.deail-con`也添加`w1300`类，保证和`head-box`垂直对齐
- 距离左侧和顶部一定的空间，保证对齐
- 每个`li`水平排列，宽度和`head-box`的每个`nav`保持一致
- 图标用雪碧图，封装成公共样式，在所有用到图标的地方，添加公共样式类，然后利用`background-position`定位到指定的图标上，可以先用截图工具量个大概，再在调试工具中精确调整
- 利用`vertical-align`设置图标和文字基于中线对齐（看情况调整）
- 最开始整个区域是不显示的

`index.html`

```html
<ul class="detail-con w1300">
</ul>
```

`common.less`

```less
.sp-top {
    background: url('../images/topfoot-spr.png') no-repeat;
    background-size: 405px 178px;
}
```

给所有要加图标的地方，加上样式类

```html
<i class="icon-new sp-top"></i>
```

`head_box.less`

```less
// 导航详情
  .nav-detail {
    display: none; // 最后加上
    position: absolute;
    top: 0;
    left: 0;
    z-index: 9;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,.7);
    .detail-con {
      display: flex;
      justify-content: flex-start;
      padding-left: 187px;
      padding-top: 78px;
      li {
        width: 140px;
        a {
          display: block;
          line-height: 30px;
          text-align: center;
          color: #fff;
          font-size: 14px;
          // 相当于a:hover
          &:hover {
            color: #e9c06c;
          }
          i {
            display: inline-block;
            width: 14px;
            height: 14px;
            vertical-align: middle;
            &.icon-hot { //相当于i.icon-hot，表示连接符
              background-position: -347px -84px; // 需要测量，或者UI给定好值
            }
            &.icon-new {
              background-position: -381px -65px;
            }
          }
        }
      }
    }
  }
```

![image-20220815151016269](image-20220815151016269.png)

#### `js`部分

- 需求：

  - 鼠标滑到`nav`时显示详情，同时附带动画效果

  - 鼠标放在详情上时，也不消失

  - 除此之外，详情消失

- `css`想要实现这样的效果，必须保证显示的内容是`hover`元素的子元素，在结构上有限制
- `head-nav`和`head-detail`不是嵌套关系，这种需求要实现，只有一种方案：事件委托
  - 浏览器事件冒泡传播机制：子元素的点击事件被触发了，其父元素、祖先元素、`document`元素（一层层往上）的点击事件也都会被触发
  - 事件对象：表示当前事件操作的信息，其中`target`值是事件源，表示真正触发事件的那个元素
  - 事件委托：给上层元素绑定事件，通过事件对象的`target`不同，来进行不同的处理，不用每个元素都处理

`index.js`

```js
import './head_box.js';

```

`head_box.js`

```js
// 基于事件委托实现导航详情的控制
let headBox = document.querySelector('#head-box'), // 通过id获取head-box容器
    navDetail = headBox.querySelector('.nav-detail'),
    headNav = headBox.querySelector('.head-nav')
// 用dom2级事件绑定（addEventListener），允许给同一个元素同一个事件行为绑定多个不同的方法
// dom0级事件绑定（onclick），只允许给同一个元素同一个事件行为绑定一个方法，绑定第二个方法会覆盖掉第一个

// 给外层元素添加事件，不能用mouseenter，因为其不存在事件冒泡机制，也就不能做事件委托
// 鼠标只要划过document里任何一个元素上，通过事件传播机制，都会触发document的mouseover行为
// 触发mouseover行为时，浏览器会帮我们把function执行，并且可以接受到事件对象
// 注意，这样实时触发事件，并不会对性能有影响；因为即使不写这些，划过每个元素，仍然都会触发每个元素的mouseover事件，仍然会触发document的事件，事件行为是天生就存在的，不管写不写代码，事件行为天生就会触发，只不过啥事不干而已；现在我们只是监听事件行为之后，让它干了点事情；并不会对性能有太大的影响；而且不需要做防抖和节流，只有频繁触发才需要做

// 获得所有的祖先元素
const getAncestors = function getAncestors(element) {
    // 一直找父元素，直到找不到父元素 document.parent = null
    let arr = [element]
    parent = element.parentNode
    while (parent) {
        arr.push(parent) // 不用unshift，每次都要调索引
        parent = parent.parentNode
    }
    return arr
}

document.addEventListener('mouseover', function (ev) {
    let target = ev.target, // 获取到事件源
        ancestors = getAncestors(target)
    // 对事件源判断，进行逻辑处理
    // console.log(target) // 拿到的事件源，可能是head-nav里的任意子元素，所以要获取当前事件源所有的祖先元素
    // 两次通过js获取到的dom元素对象，虽然也是堆内存，但两次获取的结果是相等的
    
    // 事件源是头部导航
    if(ancestors.indexOf(headNav) > -1) {
        navDetail.style.display = 'block'
        return
    }
    // 事件源是详情
    if(ancestors.indexOf(navDetail) > -1) return

    // 其他事件源
    navDetail.style.display = 'none'
})
```



动画处理

- `transition`：修改样式就按动画轨迹处理

  `head_box.less`

  ```less
      .nav-detail {
  		// 新增
          transform: translateY(-10px);
          transition: transform 0.2s;
  ```

  `head_box.js`

  ```js
      if(ancestors.indexOf(headNav) > -1) {
          navDetail.style.display = 'block'
         	navDetail.style.transform = 'translateY(0px)'; //这两个样式是会一起渲染，从none变成block的时候，动画已经结束了
          return
      }
  ```

  但并没有生效

  当代浏览器有个渲染队列机制，会先把所有和修改样式的地方，收集到队列中统一渲染，减少`dom`的回流和重绘；

  可以在是收集过程中，通过获取元素的某个属性，来刷新渲染机制

  ```js
  document.addEventListener('mouseover', function (ev) {
      let target = ev.target, // 获取到事件源
          ancestors = getAncestors(target)
      // 对事件源判断，进行逻辑处理
      // console.log(target) // 拿到的事件源，可能是head-nav里的任意子元素，所以要获取当前事件源所有的祖先元素
      // 两次通过js获取到的dom元素对象，虽然也是堆内存，但两次获取的结果是相等的
      
      // 事件源是头部导航
      if(ancestors.indexOf(headNav) > -1) {
          navDetail.style.display = 'block'
          navDetail.offsetWidth // 刷新浏览器的渲染队列机制，不用定时器
          navDetail.style.transform = 'translateY(0px)';
          return
      }
      // 事件源是详情
      if(ancestors.indexOf(navDetail) > -1) return
  
      // 其他事件源
      navDetail.style.display = 'none'
      navDetail.offsetWidth // 刷新浏览器的渲染队列机制，不用定时器
      navDetail.style.transform = 'translateY(-10px)';
  })
  ```

- `animation`

  也可以不用`transform`

  `head_box.css`

  `.head-detail`同级定义动画

  ```css
      @keyframes headMove {
          0% {
              transform: translateY(-10px);
          }
          100% {
              transform: translateY(0px);
          }
      }
  ```

  `head_box.js`

  ```js
  document.addEventListener('mouseover', function (ev) {
      let target = ev.target, // 获取到事件源
          ancestors = getAncestors(target)
      // 对事件源判断，进行逻辑处理
      // console.log(target) // 拿到的事件源，可能是head-nav里的任意子元素，所以要获取当前事件源所有的祖先元素
      // 两次通过js获取到的dom元素对象，虽然也是堆内存，但两次获取的结果是相等的
      
      // 事件源是头部导航
      if(ancestors.indexOf(headNav) > -1) {
          navDetail.style.display = 'block'
          // navDetail.offsetWidth // 刷新浏览器的渲染队列机制，不用定时器
          // navDetail.style.transform = 'translateY(0px)';
          navDetail.style.animation = 'headMove .2s both'
          return
      }
      // 事件源是详情
      if(ancestors.indexOf(navDetail) > -1) return
  
      // 其他事件源
      navDetail.style.display = 'none'
      // navDetail.offsetWidth // 刷新浏览器的渲染队列机制，不用定时器
      // navDetail.style.transform = 'translateY(-10px)';
      navDetail.style.animation = 'none'
  })
  ```

  使用`animation`动画就不用处理浏览器渲染队列机制导致的问题了

### 背景按钮

- 查看详情是用的精灵图

- 水平居中，可以先在公共样式类预设类名

- 给对应的元素添加背景图、水平居中的类名，同时删除元素中的文字

  `common.less`

  ```less
  .center-x {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
  }
  .center-y {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
  }
  
  ```

  `head_box.less`

  ```less
    // 背景按钮
    .background-btn {
      bottom: 32px;
      width: 160px;
      height: 40px;
      background-position: -216px -39px;
    }
  ```

  `index.html`

  ```html
    <!-- 背景按钮 -->
    <a href="https://lol.qq.com/act/a20220715starguardianpass/index.html?_code=507041" target="_blank"
       class="background-btn sp-top center-x">
    </a>
  ```

加上**作者区域**的布局需求

- 能够同一行展示

- 标签整体靠右（文字整体靠右用`text-align`）

- 想让标签既能够同行排列，也能够设置宽高，也能够当作文字做一些处理

- 基于以上需求，可以用`inline-block`布局方式

  `index.html`

  ```html
    <!-- 作者区域 -->
    <div class="author-box w1300">
      <span>当前游戏版本</span>
      <span>Ver 12.15</span>
      <a href="https://lol.qq.com/gicp/news/410/37008396.html" target="_blank" class="author-link">版本详情</a>
    </div>
  ```

  `head_box.less`

  和`backgroun-btn`同级

  ```less
  // 作者区域
    .author-box {
      margin-top: 223px;
      text-align: right;
      //font-size: 0;
      span, .author-link {
        display: inline-block;
        margin: 0 5px;
        vertical-align: middle;
      }
      span {
        color: #888787;
        font-size: 14px;
        &:nth-of-type(2) {
          color: #f5d185;
        }
      }
      .author-link {
        padding: 0 15px;
        height: 22px;
        line-height: 20px;
        color: #f5d185;
        font-size: 12px;
        border: 1px solid #f5d185;
        background: rgba(0,0,0,0.7);
      }
    }
  ```

  效果：

  ![image-20220816101811993](image-20220816101811993.png)

### 按钮组

- 箭头动画去查`animate.css`动画库

`common.less`

```less
.sp-comm {
  background: url("../images/comm-spr.png") no-repeat;
  background-size: 393px 200px;
}
//更多按钮箭头处理
.comm-more-arrow {
  display: inline-block;
  margin-left: 5px;
  width: 15px;
  height: 15px;
  .sp-comm;
  background-position: -213px -126px;
  &.move {
    animation: commMoreArrowMove 3s infinite;
  }
  // 需要实现的动画
  @keyframes commMoreArrowMove {

    from,
    to {
      transform: translate3d(0, 0, 0);
    }

    10%,
    30%,
    50%,
    70%,
    90% {
      transform: translate3d(-10px, 0, 0);
    }

    20%,
    40%,
    60%,
    80% {
      transform: translate3d(10px, 0, 0);
    }
  }
}
```

`index.html`

```html
   <!-- 按钮组 -->
    <!-- 个人中心 -->
    <div class="head-person">
      <div class="person-base">
        <a href="https://lol.qq.com/space/index.shtml" class="base-logo sp-top" target="_blank">
          <img src="images/default.png">
        </a>
        <span class="base-text">
						亲爱的召唤师，欢迎<a href="#" class="login">登录</a>
        </span>
      </div>
      <div class="person-detail">
        <div class="detail-text">
          <p>登录并且绑定大区后才可以查看您的具体信息哦<br/>
            (包括战绩、资产、声望）
          </p>
          <p>官网个人信息显示略有延迟，请以游戏数据为准</p>
        </div>
        <a class="detail-more" href="https://lol.qq.com/space/index.shtml" target="_blank">
          进入个人中心
          <i class="comm-more-arrow"></i>
        </a>
      </div>
    </div>
    <!--二维码-->
    <a href="https://lol.qq.com/app/index.html" class="head-weixin sp-top" target="_blank">
      <div class="wx-detail">
        <img src="images/zm-qrcode.jpg" class="zm-qrcode">
        <p>扫码下载掌上英雄联盟</p>
        <img src="images/polo.gif" class="polo">
      </div>
    </a>
    <!--搜索-->
    <a class="head-search sp-top" title="搜索">
      <!--      <span class="search-cancel"></span>-->
      <!--      <input type="text" value="搜索lol.qq.com">-->
    </a>
```

`index.js`

```js
import './head_box.js';

//编写一些公共的逻辑
let commMoreArrowList = Array.from(document.querySelectorAll('.comm-more-arrow'))
commMoreArrowList.forEach(item => {
    let parent = item.parentNode
    if(!parent) return
    parent.addEventListener('mouseenter', function () {
        item.className = 'comm-more-arrow move'
        // item.classList.add('move');
    })
    parent.addEventListener('mouseleave', function () {
        item.className = 'comm-more-arrow'
        // item.classList.remove('move');
    })
})



```

`head_box.less`

```less
    // head-search
    .head-search {
      width: 21px;
      height: 21px;
      padding-top: 0;
      margin-top: 25px;
      margin-right: 40px;
      background-position: -381px -39px;

    }

    // weixin
    .head-weixin {
      position: relative;
      width: 16px;
      height: 24px;
      padding-top: 0;
      margin-top: 25px;
      margin-right: 40px;
      background-position: -303px -84px;
      .wx-detail {
        display: none;
        position: absolute;
        top: 40px;
        left: 50%;
        width: 204px;
        height: 170px;
        padding-top: 10px;
        margin-left: -101px;
        background: rgba(0,0,0,.7);
        &:before {
          //position: absolute;
          //left: 50%;
          //transform: translateX(-50%);
          .center-x;
          top: -20px;
          content: '';
          width: 0;
          height: 0;
          padding: 0;
          font-size: 0;
          border: 10px solid transparent;
          border-bottom-color: rgba(0,0,0,.7);
        }

        .zm-qrcode {
          width: 120px;
          height: 120px;
          margin: 0 auto;
          border: 5px solid #fff;
          border-radius: 10px;
        }

        p {
          margin-top: 10px;
          text-align: center;
          color: #f5d185;
          font-size: 12px;
        }

        .polo {
          position: absolute;
          right: -25px;
          bottom: -10px;
          width: 50px;
          height: 50px;
        }
      }

      &:hover {
        .wx-detail {
          display: block;
          animation: headMove .2s both;
        }
      }
    }

    // person
    .head-person {
      position: relative;
      .person-base {
        font-size: 0; // 不是指字体大小是0px 代码自动格式化的时候，往往会设置一些适当的缩进、换行，但当元素的display为inline或者inline-block的时候，这些缩进、换行就会产生空白，导致前端页面展示变形。
        position: relative;
        z-index: 11;
        .base-logo,
        .base-text {
          display: inline-block;
          vertical-align: middle;
        }
        .base-logo {
          position: relative;
          width: 48px;
          height: 48px;
          background-position: -216px -117px;
          img {
            position: absolute;
            top: -4px;
            left: -5px;
            width: 80%;
            height: 80%;
            margin-top: 10px;
            margin-left: 10px;
            border-radius: 50%;
          }
        }
        .base-text {
          color: #fff;
          font-size: 16px;
          margin-left: 10px;
          .login {
            color: #fff3d0;
          }
        }
      }
      .person-detail {
        display: none;
        position: absolute;
        top: 0;
        left: 50%;
        z-index: 10;
        width: 310px;
        padding-top: 78px;
        margin-left: -155px;
        background: rgba(0,0,0,.7);
        .detail-text {
          margin-top: 15px;
          color: #888787;
          font-size: 12px;
          line-height: 20px;
          text-align: center;
        }
        .detail-more {
          position: relative;
          display: block;
          height: 44px;
          margin-top: 20px;
          background: #000;
          color: #fff;
          font-size: 16px;
          letter-spacing: 1px;
          line-height: 44px;
          text-align: center;
          vertical-align: middle;
          .comm-more-arrow {
            position: absolute;
            left: 220px;
            top: 18px;
          }
        }
      }
      &:hover {
        .person-detail {
          display: block;
          animation: headMove .2s both;
        }
      }
    }
```

效果：

![image-20220816145613871](image-20220816145613871.png)



## 头部导航小结

- `hover`交互效果：
  - 同级结构的可以通过事件委托，给祖先元素绑定鼠标移入移出事件，动态修改样式及动画
  - 嵌套结构，直接可以通过`css`的`hover`效果实现
  
- 其他动画效果：
  - 借助`animate.css`动画库，找到满足动画效果的`css`样式
  
- 需要补足的点（能看懂，但写不出来，`dom`操作练习的少）：
  - `js`动态操作样式
  - `js`操作`dom`、获取类名等相关`dom`操作
  
- 通用流程
  - 先准备好物料：资源背景图、尺寸图等
  - 搭建结构，
    - 在搭建结构的时候，用什么标签心里已经有数
    - 同时，这一块的布局，字体相关样式，应该也已了然于心
    - 最好能够在搭结构的时候，就已经想好交互的解决方案
  - 对于抽取的公共模块做到心中有数
  
- 常见组合拳

  - 字体相关

    ```
    font-size
    color
    lineheight
    letter-spacing: 1px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    
    text-align: center; // 父级
    vertical-align: middle; // 父级
    ```

    


## 剩余静态页面

根据上面的流程，将首页静态页面写完

轮播+新闻模块静态页面

`common.less`

```css
body {
  background-color: #eeeeee;
}
```

`index.html`

```html
<!--banner-and-news-->
<div class="banner-and-news w1300">
  <!--轮播图开始-->
  <div class="banner-box">
    <a href="">
      <img src="" alt="" class="banner-img">
    </a>
    <ul>
      <li>小怪兽训练师</li>
      <li>时空召唤</li>
      <li>浪里五鲨宝典</li>
      <li>LPL夏季赛</li>
      <li>夏日折扣</li>
    </ul>
  </div>
  <!--轮播图结束-->

  <!--新闻开始-->
  <div class="news-box">
    <ul class="news-box-header">
      <li>综合</li>
      <li>公告</li>
      <li>赛事</li>
      <li>攻略</li>
      <li>社区</li>
    </ul>
    <div class="title-header">【英雄联盟】星之守护者 - 年刊</div>
    <ul class="news-title">
      <li>
        <span class="item-category">
          <span>新闻</span>
        </span>
        <a class="item-tite">巨龙之境亚洲洲际赛即将开赛</a>
        <span class="item-time">08-14</span>
      </li>
      <li>
        <span class="item-category">
          <span>新闻</span>
        </span>
        <a class="item-tite">聊聊英雄联盟：2023季前赛打野变动</a>
        <span class="item-time">08-12</span>
      </li>
      <li>
        <span class="item-category">
          <span>视频</span>
        </span>
        <a class="item-tite">【英雄联盟】聊聊英雄联盟：英雄和2023 季前赛</a>
        <span class="item-time">08-12</span>
      </li>
      <li>
        <span class="item-category">
          <span>新闻</span>
        </span>
        <a class="item-tite">云顶之弈TOC4龙神杯赛事一图流</a>
        <span class="item-time">08-12</span>
      </li>
      <li>
        <span class="item-category">
          <span>公告</span>
        </span>
        <a class="item-tite">小怪兽训练师系列皮肤现已上线</a>
        <span class="item-time">08-10</span>
      </li>
      <li>
        <span class="item-category">
          <span>公告</span>
        </span>
        <a class="item-tite">12.15版本更新公告：神圣分离者&先攻削弱，小怪兽训练师皮肤上线</a>
        <span class="item-time">08-10</span>
      </li>
    </ul>
    <a href="" class="news-footer">
      <span class="text">阅读更多<span class="more-news">最新资讯</span><i class="comm-more-arrow"></i></span>
    </a>
  </div>
  <!--新闻结束-->
</div>
```

`index.less`

```less
@import './banner_and_box.less';
```

`banner_and_box.less`

```less
.banner-and-news {
  padding-top: 40px;

  .banner-box {
    float: left;
    width: 780px;
    height: 380px;
    background-color: peachpuff;

    .banner-img {
      width: 100%;
      height: 340px;
    }

    ul {
      display: flex;
      list-style: none;

      li {
        width: calc(780px / 5);
        height: 40px;
        background-color: #E3E2E2;
        font-size: 14px;
        color: #424242;
        text-align: center;
        letter-spacing: 1px;
        line-height: 40px;

        &:hover {
          background-color: #f7f6f6;
          color: #ab8e66;
          border-bottom: 1px solid #ab8e66;
        }
      }

    }
  }

  .news-box {
    position: relative;
    float: right;
    width: 490px;
    height: 380px;
    //background-color: lawngreen;
    overflow: hidden;
    ul.news-box-header {
      display: flex;
      list-style: none;
      width: 570px;
      height: 35px;
      li {
        width: 113px;
        height: 37px;
        border-bottom: 1px solid #d9d8d8;

        font-size: 18px;
        color: #424242;
        letter-spacing: 1px;
        text-align: left;
        &:hover {
          font-weight: bold;
          color: #1da6ba;
        }
      }
    }
    .title-header {
      height: 59px;
      font-size: 22px;
      font-weight: bold;
      color: #1DA6BA;
      line-height: 59px;
      letter-spacing: 1px;
      text-align: center;
      vertical-align: middle;
    }
    ul.news-title {

      li {
        height: 39px;
        border-top: 1px solid #d9d8d8;
        display: flex;
        justify-content: space-between;
        vertical-align: center;
        line-height: 39px;
        font-size: 14px;
        letter-spacing: 1px;

        color: #424242;
        .item-category {
          width: 45px;
          span {
            padding: 2px 5px;
            border: 0.5px solid #1DA6BA;
            font-size: 12px;
            color: #1DA6BA;
          }

        }
        .item-tite {
          width: 370px;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
          &:hover {
            color: #1DA6BA;
            cursor: pointer;
          }
        }
        .item-time {
          color: #9d9d9d;
        }
      }

    }
    .news-footer {
      position: absolute;
      bottom: 0;
      display: inline-block;
      width: 100%;
      height: 40px;
      background-color: #e3e2e2;
      text-align: center;
      vertical-align: middle;
      .text {
        font-size: 14px;
        line-height: 40px;
        letter-spacing: 1px;
        color: #676767;
        .more-news{
          color: #7EA1A6;
        }
        .comm-more-arrow {
          position: absolute;
          top: 15px;
        }
      }
    }
  }

}
```

注意：

`head-box`加个下面的样式

```css
  min-width: 1300px;
  width: 100%;
```

保证缩小窗口时，上下两栏能够始终对齐

最终效果：

![image-20220818202517609](image-20220818202517609.png)

## 轮播图模块

### 轮播图数据获取

轮播图的数据，需要动态获取，然后动态绑定到页面中

动态绑定之后，然后再实现轮播效果

数据不直接写死，后台数据在`admin`文件夹（为了练习到`axios`）

- `Node`版本`>12.0.0`
- 启动：`node server.js`，注意不能关窗口，如果想要关闭窗口服务还在，安装`npm i pm2`，启动`pm2 start server.js --name lol`，结束`pm2 stop lol`，重启`pm2 start lol`
- 可以学习一下，`mock`数据怎么简单搭建成`api`服务



想从服务器获得数据（前后端数据通信）

- 同源方案
  - `ajax`、`$ajax`基于回调函数、`axios`基于`Promise`，核心是`XMLRequest`
  - `fetch`，`ES6`中提供的新的方法
- 跨域方案
  - `jsonp`
  - `postmessage`

`http.js`

```js
const http = axios.create({
    // 统一请求前缀
    baseURL: 'http://127.0.0.1:8888',
    // 是否允许跨域时候携带资源凭证
    withCredentials: false,
    // 请求成功的状态码校验规则
    validateStatus: status => {
        return status >= 200 && status < 400;
    },
    // 请求头统一处理「设置请求主体专递给服务器的数据格式」
    headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
    },
    // POST系列请求，请求主体传递信息的格式化
    transformRequest: (data, headers) => {
        if (data !== null && typeof data === "object") {
            const ct = headers['Content-Type'];
            if (ct === "application/x-www-form-urlencoded") {
                return qs.stringify(data);
            }
        }
        return data;
    }
});

// 请求拦截器：向服务器发送请求之前
http.interceptors.request.use(config => {
    // ...
    return config;
});

// 响应拦截器：获取到响应信息 ~ 自己处理业务逻辑之间
http.interceptors.response.use(response => {
    // 获取响应主体信息
    return response.data;
}, reason => {
    // 失败的统一处理「一般就是做相关的提示或者其它操作」
    let response = reason.response;
    if (response) {
        // 服务器有返回值，但是状态码不符合validateStatus校验规则
        switch (response.status) {
            case 400:
                // ...
                break;
            case 401:
                // ...
                break;
        }
    } else {
        // 服务器没有返回任何的信息
        if (reason && reason.code === "ECONNABORTED") {
            // 超时或者请求中断
        }
        if (!navigator.onLine) {
            // 网络出现故障
        }
    }
    return Promise.reject(reason);
});

// ES6Module中模块的导出:我想把当前模块中的某个方法，某些东西暴露出去供其他模块调用 export & export default
export default http;
```



新建`swiper_container_home.js`，`index.js`中导入

`index.js`

```js
import './head_box.js';
import './swiper_container_home.js' // 记得加后缀
```

`swiper_container_home.js`

```js
import http from './http.js'

http.get('/home_banner').then(data => {
    console.log(data)
})
```

结果：

![image-20220818203901891](image-20220818203901891.png)

录播图和分页器的结构，只留一个。并且是根据服务器返回的数据动态创建的

`swiper_container_home.js`

```js
import http from './http.js'

let swiperContainerHome = document.querySelector('#swiper-container-home'),
    wrapper = swiperContainerHome.querySelector('.swiper-wrapper'),
    pagenation = swiperContainerHome.querySelector('.swiper-pagenation')
console.log(wrapper)
let step = 0 // 用来记录当前展示的是哪一个图片

// 数据绑定，根据服务器中的数据，动态拼接字符串，然后放入容器中
const binding = function binding(data) {
    let str_slide = ``,
        str_pagenation = ``

    data.forEach((item, index) => {
        str_slide += `<a href="${item.href}" targe="_blank">
                <img src="${item.pic}" alt="" class="banner-img" alt="${item.title}">
            </a>`
        str_pagenation += `<li class="${index === step ? 'active' : ''}">${item.title}</li>`
    })

    // 拼好后放入指定容器中
    wrapper.innerHTML = str_slide
    pagenation.innerHTML = str_pagenation
}

http.get('/home_banner').then(data => {
    binding(data)
})


```

修改对应结构，`index.html`

```html
    <!--轮播图开始-->
        <div class="banner-box" id="swiper-container-home">
          <div class="swiper-wrapper">
            <!-- <a href="">
                <img src="" alt="" class="banner-img">
            </a> -->
          </div>
          <ul class="swiper-pagenation">
            <!-- <li class="active">小怪兽训练师</li> -->
          </ul>
        </div>
        <!--轮播图结束-->

```

修改对应样式，`banner_and_box.less`

```css
.swiper-wrapper {
        overflow: hidden;
        height: 340px;
        .banner-img {
            width: 100%;
            height: 340px;
          }
      }

      ul {
        display: flex;
        list-style: none;
  
        li {
          width: calc(780px / 5);
          height: 40px;
          background-color: #E3E2E2;
          font-size: 14px;
          color: #424242;
          text-align: center;
          letter-spacing: 1px;
          line-height: 40px;
  
          &:hover,
          &.active {
            background-color: #f7f6f6;
            color: #ab8e66;
            border-bottom: 1px solid #ab8e66;
          }
          
        }
  
      }
    }
```

增加图片加载时的`loading`效果

- 可以是个圈圈（`loading`）
- 也可以是个架子（骨架屏）
- 也可以做百分比进度条（监听`ajax`）
  - 一般只有大文件上传的时候会处理


`common.less`

```less
/* loading */
.loading {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;

    &:before,
    &:after {
        position: absolute;
        top: 50%;
        left: 50%;
        content: '';
    }

    &:before {
        margin: -48px 0 0 -25px;
        width: 50px;
        height: 50px;
        background: url('../images/loading.svg') no-repeat center center;
        background-size: 100% 100%;
        animation: loadingMove 2s linear 0s infinite;
    }

    &:after {
        content: '小主，奴家正在努力为您加载中...';
        margin: 8px 0 0 -120px;
        width: 240px;
        height: 30px;
        line-height: 30px;
        text-align: center;
        font-size: 12px;
        color: #676767;
    }

    @keyframes loadingMove {
        100% {
            transform: rotate(360deg);
        }
    }
}


```

给轮播图增加`loading`样式类，并适当调整盒子的布局

`index.html`

```html
	<!--轮播图开始-->
	<div class="banner-box loading" id="swiper-container-home">
	  <div class="swiper-wrapper">
		<!-- <a href="">
			<img src="" alt="" class="banner-img">
		</a> -->
	  </div>
	  <ul class="swiper-pagenation">
		<!-- <li class="active">小怪兽训练师</li> -->
	  </ul>
	</div>
```

`banner_and_box.less`，主要是使得盒子恢复到原来的位置

```less
.banner-and-news {
    padding-top: 40px;
    height: 420px;
    position: relative;
    .banner-box {
      float: left;
      width: 780px;
      height: 380px;
    //   background-color: peachpuff;
      top: 40px;
      .swiper-wrapper {
        overflow: hidden;
        height: 340px;
        .banner-img {
            width: 100%;
            height: 340px;
          }
      }
  
      ul {
        display: flex;
        list-style: none;
  
        li {
          width: calc(780px / 5);
          height: 40px;
          background-color: #E3E2E2;
          font-size: 14px;
          color: #424242;
          text-align: center;
          letter-spacing: 1px;
          line-height: 40px;
  
          &:hover,
          &.active {
            background-color: #f7f6f6;
            color: #ab8e66;
            border-bottom: 1px solid #ab8e66;
          }
          
        }
  
      }
    }
}
```

数据绑定后，移出`loading`样式类

`swiper_container_home.js`

```js
http.get('/home_banner').then(data => {
    console.log(data)
    binding(data)
    swiperContainerHome.classList.remove('loading')
})


```

### 轮播图实现原理

- 需要展示的图片排列成一行，定时控制每一张图片展示在视口中
- 图片相对于与视口定位（调整`left`值）或使用`transform`调整`translateX`值
  - 整个外部容器绝对定位，图片`wrapper`相对定位，且每张图片水平排列
- 实现无缝衔接
  - 复制第一张放在末尾
  - 到末尾后，立即调到第一张（视差感受不到），然后继续轮播第二张
  - 图片`wrapper`的长度，为图片数量加一，乘以每张图片的长度（不是）

调整`banner-box`相关样式

```less
    .banner-box {
      float: left;
      width: 780px;
      height: 380px;
    //   background-color: peachpuff;
      top: 40px;
      position: relative; // 新增
      .swiper-wrapper {
        // overflow: hidden;
        position: absolute;
        left: 0;
        top: 0;
        transition: left .3s;
        display: flex;
        width: 3900px; // 后期需要动态计算
        height: 340px;
        .banner-img {
            width: 100%;
            height: 340px;
          }
      }
}
```

效果，这里暂时没有设置`overflow`为`hidden`

![image-20220819062804479](image-20220819062804479.png)



- 记录`slide`数量、宽度、轮播图的运动时间、定时器
- 定义自动轮播的函数

`swiper_container_home.js`

```js
```



备注：

-  `swiper.js`源码不难，只是处理了更多的可能性，没有特别值得学习的代码思想
- `pc`端的轮播图真用不上`swiper`，就这点代码
- 移动端涉及到`touch`，自己写也可以，但有点麻烦而已

## 页卡切换







































































































